df <- fread('c:/Users/kongmou/Desktop/Silkworm annotation/expresion_pattern.xls')
library(data.table)
df <- fread('c:/Users/kongmou/Desktop/Silkworm annotation/expresion_pattern.xls')
View(df)
df <- fread('c:/Users/kongmou/Desktop/Silkworm annotation/Stript/exp mat/expresion_pattern.xls')
View(df)
View(df)
head(df)
head()
View(df)
df <- fread('c:/Users/kongmou/Desktop/Silkworm annotation/Stript/exp mat/expression.txt')
View(df)
df <- fread('c:/Users/kongmou/Desktop/Silkworm annotation/Stript/exp mat/expresion_pattern.xls')
View(df)
object.size(df)
?object.size
object.size(df,units = "kb")
object.size(df,units = "Kb")
object.size(df,units = "auto")
object.size(df,units = "auto")
format(object.size(df),units = "auto")
test_df <- df[1:3]
View(test_df)
test_df <- df[,1:3]
View(test_df)
library(ggplot2)
colnames(test_df)
ggplot(test_df,aes(x = tissue,y = BMSK0000001)) +
geom_bar()
ggplot(test_df,aes(x = tissue,y = BMSK0000001)) +
geom_histogram()
ggplot(test_df,aes(x = tissue,y = BMSK0000001)) +
geom_bar(stat = 'identity')
library(pheatmap)
?pheatmap
library(tidyverse)
?pivot_longer
?pivot_wider
colnames(test_df)
test_df %>% pivot_wider(id_cols = stage,values_from =BMSK0000001 )
test_df %>% pivot_wider(id_cols = tissue,values_from = BMSK0000001 )
test_df %>% pivot_wider(names_from  = tissue,values_from = BMSK0000001 )
test_df2 <- test_df %>% pivot_wider(names_from  = tissue,values_from = BMSK0000001 )
View(test_df2)
pheatmap(test_df2[-1])
ComplexHeatmap::Heatmap(test_df2[-1])
?pheatmap
pheatmap(test_df2[-1],cluster_cols =F, cluster_rows  =F)
test_df2[1]
test_df2[[1]]
pheatmap(test_df2[-1],cluster_cols =F, cluster_rows  =F,annotation_col =  test_df2[[1]])
pheatmap(test_df2[-1],cluster_cols =F, cluster_rows  =F,annotation_col =  test_df2[[1]])
pheatmap(test_df2[-1],cluster_cols =F, cluster_rows  =F,annotation_col = test_df2[1])
pheatmap(test_df2[-1],cluster_cols =F, cluster_rows  =F)
pheatmap(test_df2[-1],cluster_cols =F, cluster_rows  =F,display_numbers =T)
pheatmap(test_df2[-1],cluster_cols =F, cluster_rows  =F,display_numbers =T,labels_row = test_df2[[1]])
pheatmap(test_df2[-1],cluster_cols =F, cluster_rows  =F,display_numbers =T,labels_row = test_df2[[1]],legend = F)
trans <- function(input){
row_df <- cbind(df[,1:2],input)
test_df2 <- row_df %>% pivot_wider(names_from  = tissue,values_from = colnames(input))
}
trans(df[,3])
trans <- function(input){
row_df <- cbind(df[,1:2],input)
test_df2 <- row_df %>% pivot_wider(names_from  = tissue,values_from = colnames(input))
return(test_df2)
}
trans(df[,3])
exp_list <- map(df[,3],trans)
trans <- function(input){
row_df <- cbind(df[,1:2],input)
test_df2 <- row_df %>% pivot_wider(names_from  = tissue,values_from = colnames(row_df)[3])
return(test_df2)
}
exp_list <- map(df[,3],trans)
View(exp_list)
exp_list <- map(df[,3:ncol(df)],trans)
library(progressr)
trans <- function(input){
pb()
row_df <- cbind(df[,1:2],input)
test_df2 <- row_df %>% pivot_wider(names_from  = tissue,values_from = colnames(row_df)[3])
return(test_df2)
}
with_progress({
pb <- progressr::progressor(steps = ncol(df)-3)
exp_list <- map(df[,3:ncol(df)],trans)
})
View(exp_list)
object.size(exp_list)
format(object.size(exp_list),units = 'auto')
format(object.size(df),units = 'auto')
way1 <- function(gene){
row_df <- cbind(df[,1:2],df[,gene])
test_df2 <- row_df %>% pivot_wider(names_from  = tissue,values_from = colnames(row_df)[3])
return(test_df2)
}
colnames(test_df)
way1('BMSK0000001')
way1 <- function(gene){
row_df <- cbind(df[,1:2],df[gene])
test_df2 <- row_df %>% pivot_wider(names_from  = tissue,values_from = colnames(row_df)[3])
return(test_df2)
}
way1('BMSK0000001')
df['BMSK0000001']
df[,'BMSK0000001']
way1 <- function(gene){
row_df <- cbind(df[,1:2],df[,gene])
test_df2 <- row_df %>% pivot_wider(names_from  = tissue,values_from = colnames(row_df)[3])
return(test_df2)
}
way1('BMSK0000001')
cbind(df[,1:2],df[,'BMSK0000001']
cbind(df[,1:2],df[,'BMSK0000001'])
way1 <- function(gene){
row_df <- cbind(df[,1:2],df[,gene])
test_df2 <- row_df %>% pivot_wider(names_from  = tissue,values_from = colnames(row_df)[3])
return(test_df2)
}
way1('BMSK0000001')
cbind(df[,1:2],df[,'BMSK0000001']) %>% pivot_wider(names_from  = tissue,values_from = colnames(row_df)[3])
cbind(df[,1:2],df[,'BMSK0000001']) %>% pivot_wider(names_from  = tissue,values_from = colnames(row_df)[3]) %>% colnames()
cbind(df[,1:2],df[,'BMSK0000001'])  %>% colnames()
cbind(df[,1:2],df[,'BMSK0000001'])  %>% colnames()
way1 <- function(gene){
row_df <- cbind(df[,1:2],df[,gene])
test_df2 <- row_df %>% pivot_wider(names_from  = tissue,values_from = colnames(row_df)[3])
return(test_df2)
}
way1('BMSK0000001')
way1 <- function(gene){
row_df <- cbind(df[,1:2],df[,gene])
test_df2 <- pivot_wider(row_df,names_from  = tissue,values_from = colnames(row_df)[3])
return(test_df2)
}
way1('BMSK0000001')
way1 <- function(x){
row_df <- cbind(df[,1:2],df[,x])
test_df2 <- pivot_wider(row_df,names_from  = tissue,values_from = colnames(row_df)[3])
return(test_df2)
}
way1('BMSK0000001')
way1 <- function(x){
row_df <- cbind(df[,1:2],df[,..x])
test_df2 <- pivot_wider(row_df,names_from  = tissue,values_from = colnames(row_df)[3])
return(test_df2)
}
way1('BMSK0000001')
system.time({
pheatmap(way1('BMSK0000001'),cluster_cols =F, cluster_rows  =F,display_numbers =T,labels_row = test_df2[[1]],legend = F)
})
way1('BMSK0000001')
pheatmap(way1('BMSK0000001'),cluster_cols =F, cluster_rows  =F,display_numbers =T,labels_row = test_df2[[1]],legend = F)
way1 <- function(x){
row_df <- cbind(df[,1:2],round(df[,..x],2))
test_df2 <- pivot_wider(row_df,names_from  = tissue,values_from = colnames(row_df)[3])
return(test_df2)
}
way1('BMSK0000001')
system.time({
pheatmap(test_df2[-1],cluster_cols =F, cluster_rows  =F,display_numbers =T,labels_row = test_df2[[1]],legend = F)
})
system.time({
pheatmap(way1('BMSK0000001'),cluster_cols =F, cluster_rows  =F,display_numbers =T,labels_row = test_df2[[1]],legend = F)
})
pheatmap(way1('BMSK0000001'),cluster_cols =F, cluster_rows  =F,display_numbers =T,labels_row = test_df2[[1]],legend = F)
test_df2[-1]
system.time({
pheatmap(way1('BMSK0000001')[-1],cluster_cols =F, cluster_rows  =F,display_numbers =T,labels_row = test_df2[[1]],legend = F)
})
View(test_df2)
View(exp_list)
exp_list['BMSK0000001']
system.time({
pheatmap(exp_list['BMSK0000001'][-1],cluster_cols =F, cluster_rows  =F,display_numbers =T,labels_row = test_df2[[1]],legend = F)
})
exp_list['BMSK0000001']
exp_list['BMSK0000001'][-1]
exp_list[['BMSK0000001']]
system.time({
pheatmap(exp_list[['BMSK0000001']][-1],cluster_cols =F, cluster_rows  =F,display_numbers =T,labels_row = test_df2[[1]],legend = F)
})
system.time({
pheatmap(way1('BMSK0000001')[-1],cluster_cols =F, cluster_rows  =F,display_numbers =T,labels_row = test_df2[[1]],legend = F)
})
View(exp_list)
View(exp_list)
pheatmap(exp_list[['BMSK0000002']][-1],cluster_cols =F, cluster_rows  =F,display_numbers =T,labels_row = test_df2[[1]],legend = F)
pheatmap(exp_list[['BMSK0000003']][-1],cluster_cols =F, cluster_rows  =F,display_numbers =T,labels_row = test_df2[[1]],legend = F)
pheatmap(exp_list[['BMSK0000004']][-1],cluster_cols =F, cluster_rows  =F,display_numbers =T,labels_row = test_df2[[1]],legend = F)
expression_profile <- exp_list
save(expression_profile,file = 'expression_profile.rdata')
system.time({
pheatmap(way1('BMSK0000001')[-1],cluster_cols =F, cluster_rows  =F,display_numbers =T,labels_row = test_df2[[1]],legend = F)
})
format(object.size(df),units = 'auto')
format(object.size(exp_list),units = 'auto')
View(df)
system.time({
pheatmap(exp_list[['BMSK0000001']][-1],cluster_cols =F, cluster_rows  =F,display_numbers =T,labels_row = test_df2[[1]],legend = F)
})
system.time({
pheatmap(way1('BMSK0000001')[-1],cluster_cols =F, cluster_rows  =F,display_numbers =T,labels_row = test_df2[[1]],legend = F)
})
load('KWMT2NCBI.rdata')
load('CN_3G2NCBI.rdata')
load('all_ids.rdata')
load('KEGG_info.rdata')
load('hub.rdata')
load('domain_info.rdata')
load('GO_info.rdata')
load('PMID_title.rdata')
load('KWMT2NCBI.rdata')
load('CN_3G2NCBI.rdata')
load('all_ids.rdata')
load('KEGG_info.rdata')
load('hub.rdata')
load('domain_info.rdata')
load('GO_info.rdata')
load('PMID_title.rdata')
gc()
load('KWMT2NCBI.rdata')
load('CN_3G2NCBI.rdata')
load('all_ids.rdata')
load('KEGG_info.rdata')
load('hub.rdata')
load('domain_info.rdata')
load('GO_info.rdata')
load('PMID_title.rdata')
format(object.size(GO),units = 'auto')
format(object.size(hub),units = 'auto')
View(domain_info)
View(CN_3G2NCBI)
